function normalbattleprc(e,f,l,a,o,t,r,s,i,c){var g=new Date;e:for(;;){if(flag){flag=!1;var n=images.findColorInRegion(captureScreen(),"#ffffcc",1805+xoff,238,10,6);flag=!0}if(n){if(log("found simple"),n=null,r){if(global.teamflag=!1,r=!1,flag){for(flag=!1;!images.findColorInRegion(captureScreen(),"#ffffff",teamregion[0]+teamx*s,teamregion[1],teamregion[2],teamregion[3]);)click(258+xoff,582),sleep(500);flag=!0}log("队伍设置成功")}if(l){if(global.speedflag=!1,l=!1,flag){switch(flag=!1,a){case 0:for(;!images.detectsColor(captureScreen(),"#ffffff",1489+xoff,1009,threshold=20);)click(1371+xoff,964),sleep(400);log("调速为1x");break;case 1:for(;!images.detectsColor(captureScreen(),"#e85533",1570+xoff,1017,threshold=20);)click(1371+xoff,964),sleep(400);log("调速为2x");break;case 2:default:for(;!images.detectsColor(captureScreen(),"#f85533",1558+xoff,1014,threshold=20);)click(1371+xoff,964),sleep(400);log("调速为3x")}flag=!0}log("调速成功")}click(1873+xoff,997),log("open battle");var u=threads.disposable(),p=threads.start(function(){for(var e=new Date;new Date-e<4500;){if(flag){flag=!1;var f=images.detectsColor(captureScreen(),"#ff5533",1609+xoff,137);flag=!0}if(f)if(i){for(log(f),f=null,click(1639+xoff,592),log("clicked use");;){if(flag){flag=!1;var l=images.detectsColor(captureScreen(),"#ff5533",1255+xoff,818,threshold=16);flag=!0}if(l){l=null;break}new Date-e>4500&&(log("药吃完结束脚本"),exit()),sleep(199)}click(1759+xoff,530),sleep(700),log("clicked max"),click(1442+xoff,838),log("clicked recover"),u.setAndNotify("re"),p.interrupt()}else back(),sleep(500),back(),exit();else log("ap enough");sleep(500)}u.setAndNotify("null")});if("re"==u.blockedGet())for(;;){if(flag){flag=!1;var n=images.findColorInRegion(captureScreen(),"#ffffcc",1805+xoff,238,10,6);flag=!0}if(n){n=null,click(1873+xoff,997),log("吃药成功，再次开始"),sleep(400);break}sleep(500)}for(;;){if(flag){flag=!1;var d=images.findMultiColors(captureScreen(),"#ffffff",[[-68,96,"#598ad9"],[-42,135,"#60c160"]]);flag=!0}if(d){if(log(d),d=null,log("found esc"),o){switch(global.autoflag=!1,o=!1,t){case 0:var m=images.read("/storage/emulated/0/still.jpg");break;case 1:var m=images.read("/storage/emulated/0/autoskill.jpg")}if(flag){for(flag=!1;!images.findImageInRegion(captureScreen(),m,1700+xoff,50,153,36);)click(1786+xoff,68),sleep(500);flag=!0}m.recycle(),log("人物状态设置完成")}for(sleep(3e3);;){var k=images.read("/storage/emulated/0/next.jpg");if(flag){flag=!1;var x=images.findImageInRegion(captureScreen(),k,1404+xoff,991,38,38);flag=!0}if(k.recycle(),x){if(log("found next"),e){if(sleep(100),f){if(flag){for(flag=!1;!images.detectsColor(captureScreen(),"#88dddd",647+xoff,1037);)click(699+xoff,978),sleep(100);flag=!0}log("助战开启")}else{if(flag){for(flag=!1;!images.detectsColor(captureScreen(),"#666666",598+xoff,1037);)click(699+xoff,978),sleep(100);flag=!0}log("助战关闭")}global.partflag=!1,e=!1}if(new Date-g>timelimit2){click(x.x,x.y);break e}if(!c){log("next"),click(x.x,x.y),x=null;break e}log("rebattle"),click(996+xoff,1009);continue e}log("not found next"),stuckorlose||(press(1790+xoff,186,1),press(1818+xoff,186,1)),sleep(1e3)}}else log("not found esc"),click(345+xoff,353);sleep(1e3)}}else log("not found simple"),click(409+xoff,227);sleep(1e3)}}function leftBlack(){for(var e=images.captureScreen(),f=e.height,l=0,a=f/2;l<e.width-1;){if(e.pixel(l,a)!=e.pixel(l+1,a))return 0==l?l:l+1;l++}return l+1}auto.waitFor(),images.requestScreenCapture(),sleep(300);var storage=storages.create("pref"),sell=require("卖装备.js"),xoff=leftBlack()-246,flag=!0,partflag=!0,rebattleflag=!0,speedflag=!0,speedtype=2,autotype=1,autoflag1=!0,autoflag=!0,autotype1=storage.get("autotype2",1),parttype=storage.get("partflag2",!1),teamtype=storage.get("teamtype4",0),teamtype1=storage.get("teamtype3",0),teamflag=storage.get("teamflag",!1),teamflag1=storage.get("teamflag",!1),recoverflag=storage.get("recoverflag5",!1),teamregion=[269+xoff,166,16,16],teamx=43,autoticket=storage.get("autoticket",!1),helpflag=storage.get("helpflag2",!1),helptype=storage.get("forhelp2",0),difficulty=storage.get("difficulty",2),bosstype=storage.get("bosstype",0),stuckorloseflag=storage.get("stuckorloseflag",!1),time1=new Date,timeflag=storage.get("timeflag5",!1),timelimit1=60*(60*parseInt(storage.get("hour5",0))+parseInt(storage.get("minute5",0)))*1e3,timelimit2=60*(60*parseInt(storage.get("hour6",0))+parseInt(storage.get("minute6",0)))*1e3;threads.start(function(){for(sleep(111);;){var e=images.read("/storage/emulated/0/reline.jpg");if(flag){flag=!1;try{var f=images.findImageInRegion(captureScreen(),e,1442+xoff,710,87,41)}catch(e){continue}flag=!0}if(e.recycle(),f){log(f),click(f.x,f.y),log("open reline"),f=null,sleep(2e3);var l=images.read("/storage/emulated/0/error.jpg");if(flag){flag=!1;var a=images.findImageInRegion(captureScreen(),l,1105+xoff,517,56,56);flag=!0}if(l.recycle(),a){for(log(a),click(a.x,a.y),log("click error");;){if(flag){flag=!1;try{var o=images.detectsColor(captureScreen(),"#7ae6f4",2094+xoff,78,thresholdd=15)}catch(e){flag=!0;continue}flag=!0}if(o)break;click(1112+xoff,512),sleep(2e3)}engines.execSciptFile("./工会开车.js"),exit()}else log("not found error")}else log("not found reline"),f=null;sleep(19999)}}),timeflag&&threads.start(function(){setInterval(function(){new Date-time1>timelimit1&&exit()},6e4)});e:for(;;){var questImg=images.read("/storage/emulated/0/quest.jpg");if(flag){flag=!1;try{var quest=images.findImageInRegion(captureScreen(),questImg,1869+xoff,972,137,65)}catch(e){flag=!0;continue}flag=!0}if(questImg.recycle(),quest){for(log(quest),click(quest.x,quest.y),quest=null,log("open quest"),sleep(1500),sleep(1e3),click(1927+xoff,863),sleep(3e3);;){if(flag){flag=!1;var muti=images.findColorInRegion(captureScreen(),"#ffcf3f",1862+xoff,894,6,6,threshold=10);flag=!0}if(muti){log(muti),click(muti.x,muti.y),muti=null,log("open muti");break}log("not found muti"),sleep(1500)}switch(sleep(1e3),bosstype){case 0:case 1:break;case 2:click(1290+xoff,290);break;case 3:click(1590+xoff,290);break;case 4:click(1850+xoff,290);break;case 5:click(2020+xoff,290)}sleep(1e3);f:for(;;){switch(difficulty){case 0:if(flag){flag=!1;var boss=images.findMultiColors(captureScreen(),"#ffffcc",[[-33,-25,"#9955cc"]]);flag=!0}break;case 1:if(flag){flag=!1;var boss=images.findMultiColors(captureScreen(),"#ffffcc",[[-33,-25,"#dd6622"]]);flag=!0}break;case 2:if(flag){flag=!1;var boss=images.findMultiColors(captureScreen(),"#ffffcc",[[-33,-25,"#33aabb"]]);flag=!0}}if(boss){if(log(boss),click(boss.x,boss.y),boss=null,log("open boss"),sleep(1500),flag){flag=!1;var ticketoff=images.findMultiColors(captureScreen(),"#ffffff",[[-190,-239,"#ff5533"],[-408,-133,"#ff5533"]]);flag=!0}if(ticketoff){if(autoticket){for(click(ticketoff.x,ticketoff.y),sleep(1e3),click(1745+xoff,355),sleep(3e3),normalbattleprc(partflag,parttype,speedflag,speedtype,autoflag,autotype,teamflag,teamtype,recoverflag,rebattleflag),sleep(1e3);;){if(flag){flag=!1;var a=images.findMultiColors(captureScreen(),"#ffffff",[[-24,-17,"#9955cc"]]);flag=!0}if(a){a=null;break}sleep(100)}for(back(),sleep(1500);;){if(flag){flag=!1;var muti=images.findColorInRegion(captureScreen(),"#ffcf3f",1862+xoff,894,6,6);flag=!0}if(muti){log(muti),click(muti.x,muti.y),muti=null,log("open muti");break}log("not found muti"),sleep(1500)}switch(sleep(1e3),bosstype){case 0:case 1:break;case 2:click(1290+xoff,290);break;case 3:click(1590+xoff,290);break;case 4:click(1850+xoff,290)}continue f}back(),sleep(1e3),click(2100+xoff,50),exit()}else log("ticket enough");for(;;){if(flag){flag=!1;var simple=images.findColorInRegion(captureScreen(),"#ffffcc",1805+xoff,238,10,6);flag=!0}if(simple){if(log("found simple"),simple=null,teamflag1){if(global.teamflag1=!1,teamflag1=!1,flag){for(flag=!1;!images.findColorInRegion(captureScreen(),"#ffffff",teamregion[0]+teamx*teamtype1,teamregion[1],teamregion[2],teamregion[3]);)click(258+xoff,582),sleep(500);flag=!0}log("队伍设置成功")}click(1873+xoff,997),log("open battle");break}log("not found simple"),click(1945+xoff,218),sleep(100),click(boss.x,boss.y),sleep(1500)}var stuckorlose=!1;if(stuckorloseflag)var stuckthread=threads.start(function(){for(sleep(30999),log("卡死检测开始");;){if(flag){flag=!1;var e=captureScreen(),f=images.clip(e,1173,42,157,22);flag=!0}if(f){if(log("boss hp clipped down"),log("waitting...."),sleep(14003),flag){if(flag=!1,images.findImageInRegion(captureScreen(),f,1173+xoff,42,157,22,.9)){for(f.recycle(),losethread.interrupt(),stuckorlose=!0,sleep(500),log("get stuck"),log("关闭团灭检测");!click(2066+xoff,90););for(var l=new Date;;){if(new Date-l>3500)break;if(images.detectsColor(captureScreen(),"#85dee1",1494+xoff,828,threshold=15)){for(;!click(1606+xoff,846););for(sleep(1500);!click(1375+xoff,721););log("卡死已退出"),sleep(500),stuckorlose=!1,flag=!0,stuckthread.interrupt()}else sleep(297)}}flag=!0}log("not stuck"),sleep(3197)}}}),losethread=threads.start(function(){for(sleep(20009);;){if(flag){flag=!1;var e=images.findMultiColors(captureScreen(),"#ffffff",[[306,-2,"#ffffff"],[479,5,"#ffffff"],[-425,-185,"#88dddd"],[963,-185,"#88dddd"]]);flag=!0}if(e){for(e=null,stuckorlose=!0,stuckthread.interrupt(),log("关闭卡死检测"),log("已团灭"),sleep(500);!click(767+xoff,734););for(;!click(767+xoff,734););log("团灭返回界面"),sleep(500),stuckorlose=!1,losethread.interrupt()}else log("未团灭");sleep(8307)}});for(sleep(4e3);;){for(;;){if(flag){flag=!1;var esc=images.findMultiColors(captureScreen(),"#ffffff",[[-68,96,"#598ad9"],[-42,135,"#60c160"]]);flag=!0}if(esc){log(esc),esc=null,log("have found esc");break}log("not found esc"),click(345+xoff,353),sleep(1e3)}if(autoflag1){switch(autotype1){case 0:var autoimage=images.read("/storage/emulated/0/still.jpg");click(1786+xoff,68),sleep(200);break;case 1:var autoimage=images.read("/storage/emulated/0/autoskill.jpg");global.autoflag1=!1,autoflag1=!1}if(flag){for(flag=!1;!images.findImageInRegion(captureScreen(),autoimage,1700+xoff,50,153,36);)click(1786+xoff,68),sleep(500);flag=!0}autoimage.recycle(),log("人物状态设置完成")}if(helpflag)switch(click(2128+xoff,308),sleep(700),helptype){case 0:click(2098+xoff,334);break;case 1:click(2098+xoff,469);break;case 2:click(2098+xoff,625)}for(sleep(1e3);;){if(flag){flag=!1;var esc=images.findMultiColors(captureScreen(),"#ffffff",[[-68,96,"#598ad9"],[-42,135,"#60c160"]]);flag=!0}if(esc)log("raid 未结束");else{if(stuckorloseflag&&(stuckthread.interrupt(),losethread.interrupt()),log("raid 结束"),esc=null,flag){flag=!1;var full=images.findMultiColors(captureScreen(),"#ffffff",[[-174,24,"#ff6840"],[208,17,"#ff6840"],[-449,-160,"#ff5533"],[454,-154,"#ff5533"],[-681,-534,"#88dddd"],[706,-536,"#88dddd"]]);flag=!0}if(full){for(log(full),click(full.x,full.y),sleep(3e3),click(2043+xoff,68),sleep(3e3);!sell(););continue e}switch(difficulty){case 0:if(flag){flag=!1;var boss2=images.findMultiColors(captureScreen(),"#ffffcc",[[-33,-25,"#9955cc"]]);flag=!0}break;case 1:if(flag){flag=!1;var boss2=images.findMultiColors(captureScreen(),"#ffffcc",[[-33,-25,"#dd6622"]]);flag=!0}break;case 2:if(flag){flag=!1;var boss2=images.findMultiColors(captureScreen(),"#ffffcc",[[-33,-25,"#33aabb"]]);flag=!0}}if(boss2){boss2=null;continue f}log("not found boss2"),stuckorlose||(press(1831+xoff,215,1),press(2075+xoff,347,1))}sleep(1001)}}}else log("not found boss"),click(1831+xoff,215);sleep(1e3)}}else log("not found quest"),back(),sleep(1500)}
