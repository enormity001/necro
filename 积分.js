function battleprc(e,f,a,l,r,o,g,t,i,s,c){e:for(;;){if(flag){flag=!1;var n=images.findColorInRegion(captureScreen(),"#ffffcc",1805+xoff,238,10,6);flag=!0}if(n){if(log("found simple"),g){if(global.teamflag=!1,g=!1,flag){for(flag=!1;!images.findColorInRegion(captureScreen(),"#ffffff",teamregion[0]+teamx*t,teamregion[1],teamregion[2],teamregion[3]);)click(258+xoff,582),sleep(500);flag=!0}log("队伍设置成功")}if(a){if(a=!1,flag){switch(flag=!1,l){case 0:for(;!images.detectsColor(captureScreen(),"#ffffff",1489+xoff,1009,threshold=20);)click(1371+xoff,964),sleep(400);log("调速为1x");break;case 1:for(;!images.detectsColor(captureScreen(),"#e85533",1570+xoff,1017,threshold=20);)click(1371+xoff,964),sleep(400);log("调速为2x");break;case 2:for(;!images.detectsColor(captureScreen(),"#f85533",1558+xoff,1014,threshold=20);)click(1371+xoff,964),sleep(400);log("调速为3x")}flag=!0}log("调速成功")}if(press(1798+xoff,999,1),log("open battle"),i)for(log("检测副本超时中");;)if(flag){if(flag=!1,images.findColorInRegion(captureScreen(),"#888888",1888+xoff,998,5,3)){for(back(),log("已超时");!images.findMultiColors(images.captureScreen(),"#49c0c0",[[-18,-19,"#49c0c0"],[58,28,"#49c0c0"]],{region:[2105+xoff,182,6,6]});)sleep(1e3);flag=!0;break e}log("未超时"),flag=!0;break}var d=threads.disposable(),p=threads.start(function(){for(var e=new Date;new Date-e<5e3;){if(flag){flag=!1;var f=images.detectsColor(captureScreen(),"#ff5533",1609+xoff,137);flag=!0}if(f)if(u.interrupt(),recoverflag){for(log(f),click(1639+xoff,592),log("clicked use");;){if(flag){flag=!1;var a=images.detectsColor(captureScreen(),"#ff5533",1255+xoff,818,threshold=16);flag=!0}if(a)break;new Date-e>5e3&&(log("药吃完结束脚本"),exit()),sleep(199)}for(;!click(1759+xoff,530);)log("clicked max");for(;!click(1442+xoff,838);)log("clicked recover");d.setAndNotify("re"),p.interrupt()}else back(),sleep(500),back(),exit();else log("ap enough");sleep(497)}d.setAndNotify("null")}),u=threads.start(function(){var e=new Date;for(sleep(3);new Date-e<5e3;){if(flag){flag=!1;var f=images.findMultiColors(captureScreen(),"#ffffff",[[-647,94,"#88dddd"],[-647,-480,"#88dddd"],[747,-481,"#88dddd"],[747,94,"#88dddd"]]);flag=!0}f&&(p.interrupt(),click(f.x,f.y),f=void 0,log("close pop"),sleep(200),d.setAndNotify("break"),log("超时线程结束1"),u.interrupt()),log("not found pop"),sleep(597)}d.setAndNotify("null"),log("超时线程结束2")});if("re"==d.blockedGet()){bonusflag=storage.get("partflag5",!1);continue e}if("break"==d.blockedGet())break e;for(sleep(1e3);;){if(flag){flag=!1;var m=images.findMultiColors(captureScreen(),"#ffffff",[[-68,96,"#598ad9"],[-42,135,"#60c160"]],{threshold:15});flag=!0}if(m){if(log(m),log("found esc"),r){switch(global.autoflag=!1,r=!1,o){case 0:var x=images.read("/storage/emulated/0/still.jpg");break;case 1:default:var x=images.read("/storage/emulated/0/autoskill.jpg")}if(flag){for(flag=!1;!images.findImageInRegion(captureScreen(),x,1700+xoff,50,153,36);)click(1786+xoff,68),sleep(500);flag=!0}x.recycle(),log("人物状态设置完成")}for(sleep(4e3);;){if(flag){flag=!1;var k=images.findMultiColors(captureScreen(),"#ffffff",[[-174,24,"#ff6840"],[208,17,"#ff6840"],[-449,-160,"#ff5533"],[454,-154,"#ff5533"],[-681,-534,"#88dddd"],[706,-536,"#88dddd"]]);flag=!0}if(k){for(stuckthread.interrupt(),log(k),click(k.x,k.y),sleep(3e3),click(2043+xoff,68),sleep(3e3);!sell(););sellflag=!0;break e}if(flag){flag=!1;var v=images.findMultiColors(captureScreen(),"#ffffff",[[21,5,"#ffffff"],[-149,-993,"#ffff22"],[-2,-962,"#ffff22"]]);flag=!0}if(v){if(log("found next"),e){if(sleep(100),f){if(flag){for(flag=!1;!images.detectsColor(captureScreen(),"#88dddd",647+xoff,1037);)click(699+xoff,978),sleep(100);flag=!0}log("助战开启")}else{if(flag){for(flag=!1;!images.detectsColor(captureScreen(),"#666666",598+xoff,1037);)click(699+xoff,978),sleep(100);flag=!0}log("助战关闭")}e=!1}if(sleep(13),s){if(flag){flag=!1;var y=images.findMultiColors(images.captureScreen(),"#ff5533",[[-180,-965,"#ffff22"],[-33,-934,"#ffff22"]]);flag=!0}if(y){click(y.x,y.y);break e}press(1156+xoff,1006,1),log("restart battle"),bonusflag=storage.get("partflag5",!1);continue e}if(press(1156+xoff,1006,1),c){for(var b=new Date;new Date-b<1e3;){if(flag){flag=!1;var S=images.findMultiColors(captureScreen(),"#ffffcc",[[26,6,"#ffffcc"],[74,7,"#ffffcc"],[-21,10,"#ff5533"]],{region:[920+xoff,947,90,30],threshold:15});flag=!0}if(S){click(S.x,S.y+random(12,15)),S=null,bonusflag=storage.get("partflag5",!1);continue e}sleep(50)}log("rare end"),click(v.x,v.y),v=null;break e}bonusflag=storage.get("partflag5",!1);continue e}log("not found next"),press(1790+xoff,186,1),press(1825+xoff,186,1),sleep(300)}}else log("not found esc"),click(345+xoff,353);sleep(300)}}else if(log("not found simple"),!equiprare&&bonusflag){if(flag){flag=!1;var h=images.findMultiColors(captureScreen(),"#95eaea",[[15,1,"#86dbdb"],[32,-2,"#88dddd"],[49,2,"#22ccdd"]],{threshold:15});flag=!0}if(h)click(h.x+random(5,10),h.y+random(5,10)),bonusflag=!1,log("助战 选择完成"),h=void 0;else{if(flag){flag=!1;var I=images.detectsColor(captureScreen(),"#88dddd",2098+xoff,761);flag=!0}I?click(498+xoff,890):press(2100+xoff,932,1)}}else click(409+xoff,227);sleep(300)}}function leftBlack(){var e=images.captureScreen(),r=e.height,t=0,i=r/2;if(1920==e.width)return 0;for(;t<e.width-1;){if(e.pixel(t,i)!=e.pixel(t+1,i))return 0==t?t:t+1;t++}return t+1}auto.waitFor(),images.requestScreenCapture(),sleep(300);var sell=require("卖装备.js"),xoff=leftBlack()-246,storage=storages.create("pref"),flag=!0,partflag=!0,parttype=storage.get("partflag5",!1),speedtype=storage.get("speedtype",0),speedflag=!0,autoflag=!0,autotype=2,teamflag=!0,teamtype=storage.get("teamtype2",1),teamregion=[269+xoff,166,16,16],teamx=43,overtimeflag=!0,equipflag=storage.get("equipflag",!0),designflag=storage.get("designflag",!1),rareflag=!0,sellflag=!1,bonusflag=storage.get("partflag5",!1),time=new Date,timeflag=storage.get("timeflag10",!1),timelimit=60*(60*parseInt(storage.get("hour10",0))+parseInt(storage.get("minute10",0)))*1e3,recoverflag=storage.get("recoverflag9",!0);timeflag&&threads.start(function(){setInterval(function(){new Date-time>timelimit&&exit()},6e4)}),threads.start(function(){for(sleep(111);;){var e=images.read("/storage/emulated/0/reline.jpg");if(flag){flag=!1;try{var f=images.findImageInRegion(captureScreen(),e,1442+xoff,710,87,41)}catch(e){flag=!0;continue}flag=!0}if(e.recycle(),f){log(f),click(f.x,f.y),log("open reline"),sleep(2e3);var a=images.read("/storage/emulated/0/error.jpg");if(flag){flag=!1;var l=images.findImageInRegion(captureScreen(),a,1105+xoff,517,56,56);flag=!0}if(a.recycle(),l){for(log(l),click(l.x,l.y),log("click error");;){if(flag){flag=!1;try{var r=images.detectsColor(captureScreen(),"#7ae6f4",2094+xoff,78,thresholdd=15)}catch(e){flag=!0;continue}flag=!0}if(r)break;click(1112+xoff,512),sleep(2e3)}engines.execSciptFile("./积分.js"),exit()}else log("not found error")}else log("not found reline");sleep(9999)}});e:for(;;){for(;;){var questImg=images.read("/storage/emulated/0/quest.jpg");if(flag){flag=!1;try{var quest=images.findImageInRegion(captureScreen(),questImg,1869+xoff,972,137,65)}catch(e){flag=!0;continue}flag=!0}if(questImg.recycle(),quest){log(quest),click(quest.x,quest.y),log("open quest");break}log("not found quest"),back(),sleep(1500)}for(sleep(1e3),click(1927+xoff,863),sleep(3e3);;){if(flag){flag=!1;var evenoff=images.findMultiColors(images.captureScreen(),"#49c0c0",[[-18,-19,"#49c0c0"],[58,28,"#49c0c0"]],{region:[2105+xoff,182,6,6]});flag=!0}if(evenoff){log(evenoff),log("found evenoff");break}log("not found evenoff"),click(1958+xoff,923),sleep(1e3)}sleep(1e3);f:for(;;){for(;;){if(flag){flag=!1;var evenoff=images.findMultiColors(images.captureScreen(),"#49c0c0",[[-18,-19,"#49c0c0"],[58,28,"#49c0c0"]],{region:[2105+xoff,182,6,6]});flag=!0}if(evenoff)break;sleep(300)}if(flag){flag=!1;var questbottom=images.detectsColor(captureScreen(),"#88dddd",2130+xoff,987);flag=!0}if(questbottom)for(;!images.detectsColor(captureScreen(),"#88dddd",2130+xoff,232);)click(2130+xoff,232),sleep(800);if(equipflag){var equiprareImg=images.read("/storage/emulated/0/equiprare.jpg");if(flag){flag=!1;var equiprare=images.findImageInRegion(captureScreen(),equiprareImg,1602+xoff,331,47,42);flag=!0}if(equiprareImg.recycle(),equiprare){for(log(equiprare);!click(equiprare.x,equiprare.y););if(log("open equiprare"),battleprc(partflag,!1,speedflag,2,!1,autotype,!1,teamtype,overtimeflag,!1,!0),sellflag){sellflag=!1;continue e}continue f}log("not found equiprare")}if(designflag){var designrareImg=images.read("/storage/emulated/0/designrare.jpg");if(flag){flag=!1;var designrare=images.findImageInRegion(captureScreen(),designrareImg,1602+xoff,334,45,255);flag=!0}if(designrareImg.recycle(),designrare){for(log(designrare);!click(designrare.x,designrare.y););if(log("open designrare"),battleprc(partflag,parttype,speedflag,2,!1,autotype,!1,teamtype,overtimeflag,!1,!0),sellflag){sellflag=!1;continue e}continue f}log("not found designrare")}var riskyImg=images.read("/storage/emulated/0/risky.jpg");if(flag){flag=!1;var risky=images.findImageInRegion(captureScreen(),riskyImg,1506+xoff,328,45,675);flag=!0}if(riskyImg.recycle(),risky){for(log(risky);!click(risky.x,risky.y););if(log("open risky"),battleprc(partflag,parttype,speedflag,speedtype,autoflag,autotype,teamflag,teamtype,!1,rareflag,!1),sellflag){sellflag=!1;continue e}}else{for(log("not found risky");!swipe(1958+xoff,923,1958+xoff,623,400););sleep(1e3)}}}
